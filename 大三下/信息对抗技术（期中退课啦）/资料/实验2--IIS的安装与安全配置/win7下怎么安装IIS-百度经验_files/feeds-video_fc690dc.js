define("article:widget/exp-video/feeds-video/feeds-video.js",function(e,o,i){function d(e){var o=f(".feeds-video-list-item",b);f.each(o,function(o,i){f(i).on("click",function(){if(!f(i).hasClass("current")){{f(".feeds-video-list-item",b)}I=f(".feeds-video-list-item",b).eq(o).attr("vid"),c(e,o),M=0,S=[0],L=0,U=!1;var d=e.getPosition()-y;P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-stop",source:k,videoType:"short",videoProducer:"jingyan",vid:w,stopTime:e.getPosition(),playedTime:d,videoDuration:e.getDuration()}),e.playlistItem(o),P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"click-play",source:k,videoType:"short",videoProducer:"jingyan",seedVid:j,alreadyPlay:G[o]||0,encEid:F.context("eid"),feedsVid:I,vid:I,intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),videoIndex:o,isFromPlayList:1,expFeedsVideoTestParam:D})}})}),b.on("click",".jw-icon-playback",function(){var o=e.getPlaylistIndex();setTimeout(function(){f(".jwplayer",b).hasClass("jw-state-paused")?P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-button-pause",seedVid:j,alreadyPlay:G[o]||0,encEid:F.context("eid"),feedsVid:I,intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),videoIndex:o,expFeedsVideoTestParam:D}):P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-button-play",seedVid:j,alreadyPlay:G[o]||0,encEid:F.context("eid"),feedsVid:I,intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),videoIndex:o,expFeedsVideoTestParam:D})},100)}),b.on("click",".jw-icon-volume",function(){var o=e.getPlaylistIndex(),i=e.getMute();P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-button-volume",seedVid:j,alreadyPlay:G[o]||0,encEid:F.context("eid"),feedsVid:I,intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),videoIndex:o,mute:i,expFeedsVideoTestParam:D})}),b.on("mousedown",".scrollbar",function(){var o=e.getPlaylistIndex();P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-feeds-scrollbar-click",seedVid:j,alreadyPlay:G[o]||0,videoIndex:o,encEid:F.context("eid"),intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),feedsVid:I,expFeedsVideoTestParam:D})}),b.on("mousedown",".scrollbar-inner",function(){var o=e.getPlaylistIndex();P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-feeds-scrollbar-click",seedVid:j,alreadyPlay:G[o]||0,videoIndex:o,encEid:F.context("eid"),intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),feedsVid:I,expFeedsVideoTestParam:D})});var i=0;b.on("mouseleave",".feeds-video-list-ul",function(){i=0});var d;b.on("mouseenter",".feeds-video-list-ul",function(){d=f(".feeds-video-list-ul").offset().top}),b.on("mousewheel",".feeds-video-list-ul",function(o,t){if(0===i){i=t;var n=e.getPlaylistIndex();P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-feeds-scrollbar-wheel",seedVid:j,alreadyPlay:G[n]||0,videoIndex:n,encEid:F.context("eid"),intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),feedsVid:I,expFeedsVideoTestParam:D})}var a=d-f(".feeds-video-list-ul").offset().top,s=Math.ceil(a/76);f.each(x.slice(3,3+s),function(e,o){o.hasShow||(P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"show",source:k,videoType:"short",videoProducer:"jingyan",vid:o.feedVid,isFirstShow:!0}),o.hasShow=1)})})}function t(){var e=f(".feeds-video-loading-cover");e.stop(!0,!0).animate({width:0},2e3,function(){e.css({width:"100%"})})}function n(e){var o=(f("#feeds-video-play-box"),f(".feeds-video-loading",b)),i=[];f.each(e.videoList,function(e,o){i.push({image:o.coverUrl,sources:[{file:o.playUrl}]})}),u=window.cyberplayer("feeds-video-play-container").setup({flashplayer:p.cyberplayer,width:448,height:252,autostart:!1,stretching:"uniform",volume:50,controls:!0,repeat:!1,starttime:0,playlist:i,preload:"auto",ak:"b9855350588c4b63b127cebd1d1d252b"}),u.on("ready",function(){setTimeout(function(){"1"!==D&&(u.setMute(!0),u.play(),P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"auto-play",source:k,videoType:"short",videoProducer:"jingyan",vid:I,seedVid:j,alreadyPlay:0,encEid:F.context("eid"),feedsVid:I,intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),videoIndex:0,expFeedsVideoTestParam:D}))},1500),f(".jw-text-duration",b).text("00:00"),f(".feeds-video-play-box").addClass("pause")}).on("pause",function(){var e=u.getPosition()-y;P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-stop",source:k,videoType:"short",videoProducer:"jingyan",vid:I,stopTime:u.getPosition(),playedTime:e,videoDuration:u.getDuration()}),f(".feeds-video-play-box").removeClass("playing").addClass("pause"),c(u,u.getPlaylistIndex()),A=!0}).on("play",function(){q=!1,f(".feeds-video-play-box").removeClass("pause complete playlistComplete").addClass("playing");var e=(u.getPosition(),u.getDuration()),o=u.getPlaylistIndex();y=u.getPosition(),setTimeout(function(){P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-play",source:k,videoType:"short",videoProducer:"jingyan",vid:I,beginTime:u.getPosition(),seedVid:j,videoIndex:o,encEid:F.context("eid"),intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),alreadyPlay:G[o]||0,feedsVid:I,videoDuration:e,expFeedsVideoTestParam:D})},250),G[o]=1}).on("complete",function(){C=!1,f(".feeds-video-play-box").removeClass("playing").addClass("complete");var e=f(".feeds-video-list-item",b),o=e.length,i=u.getPlaylistIndex(),d=i+1;d=d>=o?0:d;var t=u.getDuration();if(!q){var n=u.getPosition()-y;P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-end",source:k,videoType:"short",videoProducer:"jingyan",vid:I,stopTime:u.getPosition(),playedTime:n,videoDuration:t})}q=!0,P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"play-end-100",seedVid:j,videoIndex:i,encEid:F.context("eid"),intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),alreadyPlay:G[i]||0,feedsVid:I,videoDuration:t,expFeedsVideoTestParam:D}),c(u,i),0!==d&&(I=f(".feeds-video-list-item",b).eq(d).attr("vid"),P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"auto-play",source:k,videoType:"short",videoProducer:"jingyan",vid:I,seedVid:j,alreadyPlay:G[d]||0,encEid:F.context("eid"),feedsVid:I,intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),videoIndex:d,expFeedsVideoTestParam:D})),M=0,S=[0],L=0}).on("playlistItem",function(){var e=u.getPlaylistIndex();("1"!==D||0!==e)&&(t(),o.show(),m&&window.clearInterval(m),m=setInterval(t,2e3)),I=f(".feeds-video-list-item",b).eq(e).attr("vid");var i=f(".feeds-video-list-item",b);i.removeClass("current").eq(e).addClass("current")}).on("error",function(){f(".feeds-video-play-box").removeClass("playing complete pause").addClass("error"),m&&window.clearInterval(m),o.hide(),f(".jw-title",b).text("哎呀，视频出错啦，请刷新页面重新开始播放视频").show(),f(".jw-text-duration",b).text("00:00"),P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"play-err",source:k,videoType:"short",videoProducer:"jingyan",vid:I,seedVid:j,encEid:F.context("eid"),feedsVid:I})}).on("playlistComplete",function(){f(".feeds-video-play-box").removeClass("playing complete pause").addClass("playlistComplete"),m&&window.clearInterval(m),o.show()}).on("time",function(e){var i=f(".jw-title",b);if(e.position>0){m&&window.clearInterval(m),o.hide();var d=u.getPlaylistIndex();if(e.position<.2){var t=92.5;0===d?t=100:1===d?t=97.5:2===d&&(t=95),i.text("为您找到与问题匹配度"+t+"%的视频").show(),setTimeout(function(){i.hide()},2500)}var n=parseInt(u.getDuration()-e.position,10);5>=n&&n>0?d!==u.getPlaylist().length-1&&i.text(n+"秒后即将播放下一条视频").show():e.position>=0&&-1!==i.text().indexOf("将播放下一条视频")&&i.hide();var s=e.position,r=u.getDuration(),l=Math.floor(.8*r);if(s>=l){if(C)return;P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"play-end-80",seedVid:j,encEid:F.context("eid"),feedsVid:I,intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),videoIndex:u.getPlaylistIndex(),videoDuration:r,expFeedsVideoTestParam:D}),C=!0}else C=!1}a(e,r),w=I}).on("fullscreen",function(e){if(e.fullscreen){var o=u.getPosition(),i=u.getDuration(),d=u.getPlaylistIndex();P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-button-fullscreen",seedVid:j,videoIndex:d,encEid:F.context("eid"),intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),alreadyPlay:G[d]||0,feedsVid:I,playTime:o,videoDuration:i,expFeedsVideoTestParam:D})}}).on("mediaError",function(){f(".feeds-video-play-box").removeClass("playing complete pause").addClass("error"),m&&window.clearInterval(m),o.hide(),f(".jwplayer",b).addClass("jw-state-error"),f(".jw-title",b).text("哎呀，网络连接断了，请重连网络后刷新页面重新开始播放视频").show(),P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"play-err",vid:I,seedVid:j,encEid:F.context("eid"),feedsVid:I})}).on("beforePlay",function(){var e=u.getPlaylistIndex();"1"===D&&0===e&&f(".jwplayer",b).hasClass("jw-state-idle")&&P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"click-play",source:k,videoType:"short",videoProducer:"jingyan",vid:I,seedVid:j,alreadyPlay:G[e]||0,encEid:F.context("eid"),feedsVid:I,intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),videoIndex:e,isFromPlayList:0,expFeedsVideoTestParam:D})}),d(u)}function a(e,o){if(h=e.position,g=Math.abs(h-L),g>z){if(S.push(0),M=h,A)A=!1;else{var i=L-y;P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-stop",source:k,videoType:"short",videoProducer:"jingyan",vid:I,stopTime:L,playedTime:i,videoDuration:o}),P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-play",source:k,videoType:"short",videoProducer:"jingyan",vid:I,beginTime:h,videoDuration:o})}y=h}else{var d=Math.abs(h-M);S[S.length-1]=d}L=h,U||(V=S.reduce(function(e,o){return e+o}),V>3&&(P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"valid-play",source:k,videoType:"short",videoProducer:"jingyan",vid:I}),U=!0))}function s(){f("#feeds-video-list-box").addClass("scrollbar-inner").scrollbar()}function r(){if(!E){var e=f(".feeds-video-play-box");if(u){var o=f(".video-originate-container")[0];if(f(window).scrollTop()>e.offset().top+280){e.addClass("miniVideo");var i=v.dom.q("content-container")[0],d=parseInt(v.dom.getCurrentStyle(i,"width"),10),t=(Math.max(v.page.getViewHeight(),434),v.page.getViewWidth()),n=Math.max((t-d)/2,60)-60;v.dom.fixable(o,{vertival:"bottom",horizontal:"right",offset:{x:n+60,y:10},autofix:!0}),o.style.display="block"}else o.style.position="static",e.removeClass("miniVideo")}}}function l(e){x=e.videoList,f.each(x,function(e,o){o.hasShow=3>e?1:0});var o=x.slice(0,3);f.each(o,function(e,o){P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"show",source:k,videoType:"short",videoProducer:"jingyan",vid:o.feedVid,isFirstShow:!0})});var i=window.navigator.userAgent.toLowerCase();if((i.match(/msie\s\d+/)&&i.match(/msie\s\d+/)[0]||i.match(/trident\s?\d+/)&&i.match(/trident\s?\d+/)[0])&&(window.ieVersion=i.match(/msie\s\d+/)[0].match(/\d+/)[0]||i.match(/trident\s?\d+/)[0],window.ieVersion<=8)){var d=['<div class="feeds-video-play-ie">','<div class="feeds-video-play-ie-icon"></div>','<div class="feeds-video-play-ie-text">',"<p>哎呀，当前浏览器无法播放该视频，</p>","<p>请升级到最新版本的浏览器。</p>","</div>",'<a class="feeds-video-play-ie-tip" href="/article/fdbd4277c385f2b89e3f488c.html" target="_blank">',"如何升级</a>","</div>"].join("");return f(".feeds-video-play-box").html(d),void P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"page-show",ifie:1,seedVid:j,encEid:F.context("eid"),intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),feedsVid:I,expFeedsVideoTestParam:D})}var t=T.find(".feeds-video-list-item-0").attr("vid");I=j=t,F.context("feedVideoGroup",T.attr("feed-group")),P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"page-show",seedVid:j,encEid:F.context("eid"),intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),feedsVid:I,expFeedsVideoTestParam:D}),n(e),s();var a=f(".video-originate-container");f(".video-mini-back",a).on("click",function(e){e.preventDefault(),f("html, body").animate({scrollTop:f(".feeds-video-play-box").offset().top-64},500)}),f(".video-mini-pause",a).on("click",function(e){e.preventDefault(),u&&u.pause()}),f(".video-mini-replay",a).on("click",function(e){e.preventDefault(),u&&u.play()}),f(".video-mini-play",a).on("click",function(e){e.preventDefault(),u&&u.play()}),f(".video-originate-mini-close",a).on("click",function(e){e.preventDefault(),E=!0,a.css({position:"static"}),f(".feeds-video-play-box").removeClass("miniVideo")}),f(window).on("scroll resize",r)}function c(e,o){P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds",action:"video-stop",stopTime:e.getPosition(),videoDuration:e.getDuration(),seedVid:j,alreadyPlay:G[o]||0,encEid:F.context("eid"),feedsVid:I,intention:"video-feeds-log",feedVideoGroup:F.context("feedVideoGroup"),videoIndex:o,isFromPlayList:1,expFeedsVideoTestParam:D})}var f=e("common-jquery:widget/lib/jquery/jquery.js"),v=e("common:widget/lib/tangram/base/base.js"),p=e("common-jquery:widget/js/util/uri/uri.js");e("common-jquery:widget/js/ui/scrollbar-new/scrollbar-new.js"),e("common-jquery:widget/lib/jquery.ui/jquery.ui.mousewheel.js");var u,m,y,x,g,h,V,w,P=e("common-jquery:widget/js/logic/log/log.js"),b=f(".feeds-video-box"),T=f(".feeds-video-list-ul"),j=0,I=F.context("feedsVid"),G={},C=!1,D=F.context("expFeedsVideoTestParam"),E=!1,k=/https?:\/\/(?:m|m5|www)\.baidu\.com/.test(document.referrer)?"search":"others",q=!1,M=0,S=[0],L=0,z=1,U=!1,A=!1;P.send(location.href,2019,{module:"article",page:"index",pos:"video-feeds-header",action:"show",source:k,videoType:"short",videoProducer:"jingyan",vid:I,isFirstShow:!0}),i.exports.init=l});